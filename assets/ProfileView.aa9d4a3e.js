import{u as E,a as V,b as y,k,o as n,j as m,w as l,c as b,n as i,d as o,G as u,p as d,v as _,H as g,h,g as S,m as w,E as C,A as x,T,f as P,e as U,D as B,q as F,t as j,i as A,F as D,s as N}from"./index.f9402bec.js";import{_ as $}from"./TweetVuetify.vue_vue_type_style_index_0_lang.915b7aa6.js";const R={key:0,class:"modal-mask"},z={class:"modal-wrapper"},I={class:"modal-container"},q={class:"modal-body"},G={class:"modal-footer"},H=E(),v=V(),c=y(),J=`${U}`,L={name:"SignUp",props:{show:Boolean},emits:["closeEditPopUp"],data(){return{form:!1,rules:{link:[t=>/^(https?:\/\/.*\.(?:png|jpg))?$/.test(t)||"Enter a valid image link png or jpg"]}}},methods:{async updateUserData(){this.$emit("closeEditPopUp"),await P.put(`${J}/user/${H.user_id}`,{changes:c.user_profile_changes}).then(t=>{c.logged_user.pfp_url=c.user_profile_changes.pfp_url,v.successSnackbar(t.message)}).catch(t=>{v.error(t.err),console.log(t.err)})}}},M=k({...L,setup(t){const s=y();return(a,e)=>(n(),m(T,{name:"modal"},{default:l(()=>[t.show?(n(),b("div",R,[i("div",z,[i("div",I,[o(g,null,{default:l(()=>[o(u,{cols:"9"},{default:l(()=>[d(" Edit Profile ")]),_:1}),o(u,{class:"text-center"},{default:l(()=>[o(_,{onClick:e[0]||(e[0]=r=>a.$emit("closeEditPopUp")),rounded:"",icon:"mdi-close",class:"mx-auto",size:"x-small",style:{display:"block","background-color":"grey",color:"black"}})]),_:1})]),_:1}),i("div",q,[o(C,{ref:"form",modelValue:a.form,"onUpdate:modelValue":e[2]||(e[2]=r=>a.form=r)},{default:l(()=>[o(h,{style:{width:"100%","justify-content":"center","align-items":"center"}},{default:l(()=>[o(S,{"prepend-icon":"mdi-image",label:"Url Profile Photo",type:"text",rules:a.rules.link,"hide-details":"auto",modelValue:w(s).user_profile_changes.pfp_url,"onUpdate:modelValue":e[1]||(e[1]=r=>w(s).user_profile_changes.pfp_url=r),style:{width:"100%","justify-content":"center","align-items":"center"}},null,8,["rules","modelValue"])]),_:1})]),_:1},8,["modelValue"])]),i("div",G,[o(_,{onClick:a.updateUserData,rounded:"",elevation:"2",class:"mx-auto",style:{display:"block","background-color":"#0ebbb5",color:"white"}},{default:l(()=>[d("Save")]),_:1},8,["onClick"])])])])])):x("",!0)]),_:1}))}});const W=`${U}`,p=y(),f=V(),K={name:"SignUp",components:{TweetVuetify:$},data(){return{textAreaValue:"",user:N(p).logged_user,showEditProfilePopUp:!1,publications:new Array}},methods:{async removeTweetComponent(t){console.log("removing form element",t);const s=this.publications.findIndex(a=>a.id===t);this.publications.splice(s,1),f.successSnackbar("Tweet deleted")},addTweetFirst(t){this.publications.push({id:t.id,username:this.user.username,text:t.content.text,date:t.date,fav_count:t.fav_count,liked:t.liked,pfp_url:t.pfp_url})}},async beforeMount(){await p.getById(this.$route.params.userID);const t=p.tweets;t!==null&&t.forEach(async a=>{await P.get(`${W}/publication/${a}`,null).then(e=>{e.message&&f.successSnackbar(e.message),e.pfp_url||(e.pfp_url="/E07/logo_without_letters.png");let r={id:e._id,username:e.owner_username,content:{text:e.content.text},date:e.date,fav_count:e.fav_count,liked:e.liked,pfp_url:e.pfp_url};this.addTweetFirst(r)}).catch(e=>{f.error(e.err)})})}},O=k({...K,setup(t){return(s,a)=>(n(),m(h,null,{default:l(()=>[o(M,{show:s.showEditProfilePopUp,onCloseEditPopUp:a[0]||(a[0]=e=>s.showEditProfilePopUp=!1)},null,8,["show"]),o(g,null,{default:l(()=>[o(u,{"align-self":"center"},{default:l(()=>[o(B,{"data-testid":"profile-user-pfp",src:s.user.pfp_url,"aspect-ratio":"6"},null,8,["src"])]),_:1})]),_:1}),o(g,null,{default:l(()=>[o(u,{"align-self":"center"},{default:l(()=>[o(F,{"data-testid":"profile-user-name",style:{"text-align":"center","font-size":"33px"}},{default:l(()=>[d(j(s.user.username)+" ",1),o(_,{onClick:a[1]||(a[1]=e=>s.showEditProfilePopUp=!s.showEditProfilePopUp),"prepend-icon":"mdi-pencil",color:"grey",size:"small"},{default:l(()=>[d(" Edit ")]),_:1})]),_:1})]),_:1})]),_:1}),o(h,null,{default:l(()=>[(n(!0),b(D,null,A(s.publications,e=>(n(),m($,{key:e.id,tweet:e,style:{"border-bottom":"1px solid grey"},onRemove:s.removeTweetComponent},null,8,["tweet","onRemove"]))),128))]),_:1})]),_:1}))}}),Y=k({__name:"ProfileView",setup(t){return(s,a)=>(n(),b("main",null,[o(O)]))}});export{Y as default};
