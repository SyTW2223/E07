import{_ as x}from"./TweetVuetify.vue_vue_type_style_index_0_lang.0c04b846.js";import{k as p,o,j as i,w as a,d as n,q as $,l as b,m as f,R as h,n as v,p as w,t as g,V as C,C as A,b as S,a as T,c as _,A as k,h as c,g as y,F as V,i as F,f as u,e as B}from"./index.5810f008.js";const I=["src"],L={props:["comment"]},N=p({...L,__name:"CommentVuetify",setup(t){return(e,r)=>(o(),i(A,{style:{width:"80%",margin:"0 auto","border-radius":"2px"}},{default:a(()=>[n($,null,{default:a(()=>[n(b,{size:"30px"},{default:a(()=>[n(f(h),{to:`/${t.comment.user.username}`},{default:a(()=>[v("img",{style:{"max-width":"80%","max-height":"80%"},src:t.comment.user.pfp_url,alt:""},null,8,I)]),_:1},8,["to"])]),_:1}),n(f(h),{style:{"margin-left":"5px"},class:"username-link",to:`/${t.comment.username}`},{default:a(()=>[w(g(t.comment.user.username),1)]),_:1},8,["to"])]),_:1}),n(C,null,{default:a(()=>[w(g(t.comment.text),1)]),_:1})]),_:1}))}}),m=`${B}`,d=S(),s=T(),D={emits:["remove"],data:()=>({commentAreaValue:"",liked:!1,fav_count:0,tweet:{},tweet_loaded:!1,comments:[]}),created(){},methods:{async likeTweet(t){this.liked=!this.liked,await u.put(`${m}/publication/${t}`,{liked:this.liked}).then(()=>{this.liked?(s.successSnackbar("Tweet liked"),this.fav_count+=1):(s.successSnackbar("Like removed from tweet"),this.fav_count+=-1),console.log(this.fav_count)}).catch(e=>{s.error(e.err),console.log(e.err)})},commentOnTweet(t){s.successSnackbar("HOLA")},async deleteTweet(t){await u.delete(`${m}/publication/${t}`,null).then(()=>{this.$emit("remove",t)}).catch(e=>{s.error(e.err),console.log(e.err)})},async postComment(){return await u.put(`${m}/publication/comment/${this.tweet.id}`,{user:{username:d.logged_user.username},text:this.commentAreaValue}).then(()=>{let t={user:{username:d.logged_user.username,pfp_url:d.logged_user.pfp_url},text:this.commentAreaValue};this.addCommentFirst(t),this.commentAreaValue="",s.successSnackbar("Comment added")}).catch(t=>{s.error(t.err)})},addCommentFirst(t){this.comments.unshift({user:{username:t.user.username,pfp_url:t.user.pfp_url},text:t.text})}},async beforeCreate(){const t=this.$route.params.tweetID;await u.get(`${m}/publication/${t}`,null).then(e=>{e.pfp_url||(e.pfp_url="/E07/logo_without_letters.png");const r={id:e._id,username:e.owner_username,text:e.content.text,date:e.date,fav_count:e.fav_count,liked:e.liked,comments_count:e.comments_count,pfp_url:e.pfp_url,comments:e.comments};this.tweet=r,this.comments=r.comments,this.tweet_loaded=!0}).catch(e=>{s.error(e.err)})}},P=p({...D,__name:"CommentPage",setup(t){return(e,r)=>(o(),_(V,null,[n(c,null,{default:a(()=>[e.tweet_loaded?(o(),i(x,{key:0,tweet:e.tweet},null,8,["tweet"])):k("",!0)]),_:1}),n(c,null,{default:a(()=>[n(C,null,{default:a(()=>[n(y,{density:"compact",variant:"solo",label:"Write here to add a comment...","append-inner-icon":e.commentAreaValue.length>0?"mdi-pencil":"undefined","single-line":"","hide-details":"",modelValue:e.commentAreaValue,"onUpdate:modelValue":r[0]||(r[0]=l=>e.commentAreaValue=l),"onClick:appendInner":e.postComment},null,8,["append-inner-icon","modelValue","onClick:appendInner"])]),_:1})]),_:1}),e.tweet_loaded?(o(),i(c,{key:0},{default:a(()=>[(o(!0),_(V,null,F(e.comments,l=>(o(),i(N,{key:l.user.username,comment:l,style:{"border-bottom":"1px solid grey"}},null,8,["comment"]))),128))]),_:1})):k("",!0)],64))}});const O=p({__name:"TweetPageView",setup(t){return(e,r)=>(o(),_("main",null,[n(P)]))}});export{O as default};
